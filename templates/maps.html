<html>

<head>

    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.3.0/dist/leaflet.css" />
    <link rel="stylesheet" href="../static/css/leaflet-search.css" />
    <link rel="stylesheet" href="../static/css/style.css" />
    <script src="https://unpkg.com/jquery@3.3.1/dist/jquery.js"></script>
    <script src="https://unpkg.com/leaflet@1.3.0/dist/leaflet.js"></script>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.7.1/dist/leaflet.css" integrity="sha512-xodZBNTC5n17Xt2atTPuE1HxjVMSvLVW9ocqUKLsCC5CXdbqCmblAshOMAS6/keqq/sMZMZ19scR4PsZChSR7A==" crossorigin="" />
    <script src="https://unpkg.com/leaflet@1.7.1/dist/leaflet.js" integrity="sha512-XQoYMqMTK8LvdxXYG3nZ448hOEQiglfqkJs1NOQV44cWnUrBc8PkAOcXy20w0vlaXaVUearIOBhiXZ5V3ynxwA==" crossorigin=""></script>
    <title></title>
    <style>
        #map {
            width: 100%;
            height: 800px;
        }
    </style>
</head>

<body>
    <!-- <div class="maptest_wrap">
        <h4>search in GeoJSON</h4>
        <div id="map_vector" class="maptest"></div>
        <script src="https://unpkg.com/jquery@3.3.1/dist/jquery.js"></script>
        <script src="https://unpkg.com/leaflet@1.3.0/dist/leaflet.js"></script>
        <script src="../src/leaflet-search.js"></script>
        <script src="data/us-states.js"></script>
        <script>
            var map = new L.Map('map_vector', {
                zoom: 5,
                center: new L.latLng([37.8, -96])
            });

            map.addLayer(new L.TileLayer('http://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png')); //base layer

            var featuresLayer = new L.GeoJSON(us_states, {
                style: function(f) {
                    return {
                        color: f.properties.color
                    };
                }
            });

            map.addLayer(featuresLayer);

            var searchControl = new L.Control.Search({
                layer: featuresLayer,
                propertyName: 'name',
                marker: false
            });

            searchControl.on('search:locationfound', function(e) {

                e.layer.setStyle({
                    fillColor: '#3f0',
                    color: '#0f0'
                });

            }).on('search:collapsed', function(e) {

                featuresLayer.eachLayer(function(layer) { //restore feature color
                    featuresLayer.resetStyle(layer);
                });
            });

            map.addControl(searchControl); //inizialize search control
        </script>
    </div> -->

    <input type="hidden" id="geo" value="{{data}}">
    <div id="map" class="map"></div>
    <script type="text/javascript" src="../static/js/leaflet-search.js"></script>

    <script>
        var geo = JSON.parse(document.getElementById("geo").value);

        // var data1 = JSON.parse(geo);

        var data = [{
            "loc": [41.575330, 13.102411],
            "title": "aquamarine"
        }, {
            "loc": [41.575730, 13.002411],
            "title": "black"
        }, {
            "loc": [41.807149, 13.162994],
            "title": "blue"
        }, {
            "loc": [41.507149, 13.172994],
            "title": "chocolate"
        }, {
            "loc": [41.847149, 14.132994],
            "title": "coral"
        }, {
            "loc": [41.219190, 13.062145],
            "title": "cyan"
        }, {
            "loc": [41.344190, 13.242145],
            "title": "darkblue"
        }, {
            "loc": [41.679190, 13.122145],
            "title": "darkred"
        }, {
            "loc": [41.329190, 13.192145],
            "title": "darkgray"
        }, {
            "loc": [41.379290, 13.122545],
            "title": "dodgerblue"
        }, {
            "loc": [41.409190, 13.362145],
            "title": "gray"
        }, {
            "loc": [41.794008, 12.583884],
            "title": "green"
        }, {
            "loc": [41.805008, 12.982884],
            "title": "greenyellow"
        }, {
            "loc": [41.536175, 13.273590],
            "title": "red"
        }, {
            "loc": [41.516175, 13.373590],
            "title": "rosybrown"
        }, {
            "loc": [41.506175, 13.173590],
            "title": "royalblue"
        }, {
            "loc": [41.836175, 13.673590],
            "title": "salmon"
        }, {
            "loc": [41.796175, 13.570590],
            "title": "seagreen"
        }, {
            "loc": [41.436175, 13.573590],
            "title": "seashell"
        }, {
            "loc": [41.336175, 13.973590],
            "title": "silver"
        }, {
            "loc": [41.236175, 13.273590],
            "title": "skyblue"
        }, {
            "loc": [41.546175, 13.473590],
            "title": "yellow"
        }, {
            "loc": [41.239190, 13.032145],
            "title": "white"
        }];

        console.log(geo);
        console.log(data);
        var map = new L.Map('map', {
            zoom: 9,
            center: new L.latLng(geo[0].loc)
        }); //set center from first location

        map.addLayer(new L.TileLayer('http://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png')); //base layer

        var markersLayer = new L.LayerGroup(); //layer contain searched elements
        map.addLayer(markersLayer);

        map.addControl(new L.Control.Search({
            layer: markersLayer
        })); //inizialize search control

        ////////////populate map with markers from sample data
        for (i in geo) {
            var title = geo[i].title, //value searched
                loc = geo[i].loc, //position found
                marker = new L.Marker(new L.latLng(loc), {
                    title: title
                }); //se property searched
            marker.bindPopup('title: ' + title);
            // marker.bindPopup('<img src="' + img + '"/>');
            markersLayer.addLayer(marker);
        }
    </script>


</body>

</html>